{% block header %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />

    <title>Project Manager</title>

    <link type="text/css" rel="stylesheet" href="/css/bootstrap/bootstrap.css">
    <link type="text/css" rel="stylesheet" href="/css/bootstrap/responsive.css">
    <link rel="stylesheet" type="text/css" href="/css/original-style.css" >
    <link rel="stylesheet" type="text/css" href="/css/styles.css" >

    <script type="text/javascript" src="/js/jquery/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery/jquery.cookie.js" ></script>
    <script type="text/javascript" src="/js/jquery/jquery.easing.1.3.js" ></script>
    <script type="text/javascript" src="/js/jquery/jquery-validate.min.js" ></script>
    <script type="text/javascript" src="/js/jquery/jquery.dataTables.min.js" ></script>
    <script type="text/javascript" src="/js/bootstrap/bootstrap.js"></script>
    <script type="text/javascript" src="/js/bootstrap/bootstrap-dropdown.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Jockey+One' rel='stylesheet' type='text/css'>

    <script type="text/javascript" language="javascript" src="/js/master.js" ></script>

    <script type="text/javascript" language="javascript" src="/js/toolBar/toolBar.js" ></script>
    <script type="text/javascript" language="javascript" src="/js/toolBar/toolBarController.js" ></script>

</head>

{% endblock %}
<body>
<input type="hidden" value="{% if alert is defined and alert == true %}{{ alert }}{% else %}false{% endif %}" name="alert" id="alertHeader"/>
{% if SESSION.User is defined %}
    {% set User = SESSION.User %}
    {% set currentProject = SESSION.User.currentProject %}
{% endif %}
<header>
    <div id="panel">
        <div class="navbar navbar-inverse navbar-fixed-top" id="advanced">
            <span class="trigger"><strong></strong><em></em></span>
            <div class="navbar-inner" style="padding-left: 30px">
                <button type="button" class="btn btn-navbar " data-toggle="collapse" data-target=".nav-top-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
                <a class="brand" href="/">ProjectManager</a>
                <div class="nav-collapse collapse nav-top-collapse">
                    <ul id ="toolBar" class="nav">
                        <li class="home"><a href="/"><img src="/img/tm_home.png"></a></li>
                        <li class="divider-vertical"></li>
                        <li>
                            <div class=" headerAdminBlock">
                                <a data-target="#" id="HeaderAction" onclick="javascript:toolBarController(this.id,{% if homeContext == true %}'home'{% else %}{{ User.acl_group_id }}{% endif %});" class="pull-left headerAdminButton" >+</a>
                                <div class=" pull-left headerAdminLinks" >
                                    {% if homeContext == true %}
                                        <a id="addProjectLink" class="linkBlack pull-left" data-toggle="modal" href="#add-project" onclick="javascript:toolBarLinks(this.id,null,null);">Project</a>
                                    {% else %}

                                        {% if User.acl_group_id <= 3 %}
                                            <a id="addTicketLink" class="linkBlack pull-left" data-toggle="modal" data-target="#modalHeadersLarge">Ticket</a>
                                        {% endif %}

                                        {% if User.acl_group_id == 2 or User.acl_group_id == 1 %}
                                            <a id="addRoadmapLink" class="linkBlack pull-left" data-toggle="modal" href="#add-roadmap" onclick="javascript:toolBarLinks(this.id,'{{ currentProject.project_id }}','{{ currentProject.project_code }}');">Roadmap</a>
                                            <a id="addServiceLink" class="linkBlack pull-left" data-toggle="modal" href="#add-SERVICE" onclick="javascript:toolBarLinks(this.id,'{{ currentProject.project_id }}','{{ currentProject.project_code }}');">Service</a>
                                            <a id="addMemberLink" class="linkBlack pull-left" data-toggle="modal" href="#add-member" onclick="javascript:toolBarLinks(this.id,'{{ currentProject.project_id }}','{{ currentProject.project_code }}');">Member</a>
                                            <a id="addAnnounceLink" class="linkBlack pull-left" data-toggle="modal" href="#add-announce" onclick="javascript:toolBarLinks(this.id,'{{ currentProject.project_id }}','{{ currentProject.project_code }}');">Announce</a>
                                        {% endif %}
                                    {% endif %}
                                </div>
                             </div>
                        </li>
                        <li>
                            <div id="HeaderSearchBlock" class=" headerAdminBlock">
                                <a data-target="#" id="HeaderSearch" class="pull-left headerAdminButton" >+</a>
                                <form id="headerSearchBar" class="navbar-search pull-left">
                                    <input type="text" class="search-query" placeholder="Search">
                                </form>
                            </div>
                        </li>
                        <li class="divider-vertical"></li>
                    </ul>
                    <div id="headerAlert" class="span2 pull-left">

                    </div>
                    <ul id="linkParams" class=" nav pull-right">
                        <li><div class="dropdown">
                                <a class="dropdown-toggle" id="dLabel" role="button" data-toggle="dropdown" data-target="#" >
                                    Params
                                    <b class="caret"></b>
                                </a>
                                <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                    <a href="/my-account">My acount</a>
                                    <a href="/my-account">Settings</a>
                                    <a href="/deconnect">Deconnexion</a>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>
<div class="bg-content">
    <div class="container">
        {% include header with {'header' : header } %}
    </div>
    {%  if subMenu == false %}
    <div class="row-fluid" id="subMenuBar">
        <div class="container">
            <div class="span7 offset3">
                <div id="sub-menu">
                    <ul >
                        <li {% if subMenuCurrent == 'dashboard' %}class="current" {% endif %} id="DashboardSubMenu"><a href="/{{ currentProject.project_code }}">Dashboard</a></li>
                        <li {% if subMenuCurrent == 'tickets' %}class="current" {% endif %} id="TicketSubMenu"><a href="/{{ currentProject.project_code }}/tickets">Tickets</a></li>
                        <li {% if subMenuCurrent == 'activity' %}class="current" {% endif %} id="ActivitySubMenu"><a href="/{{ currentProject.project_code }}/activity">Activity</a></li>
                        <li {% if subMenuCurrent == 'roadmaps' %}class="current" {% endif %} id="RoadmapSubMenu"><a href="/{{ currentProject.project_code }}/roadmaps">Roadmaps</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    {%  endif %}

    <div id="content" class="content-extra">
        <div class="row-1">

            <div class="container">
                <div class="span12">
                    {% include '/ariane/ariane.html.twig' with {'params' : paramsAriane }%}
                </div>
                {% block content %}


                {% endblock %}
            </div>
        </div>
    </div>

    {% block footer %}
    <footer>
        <div class="container clearfix">
            <div class="row">
                <article class="span10">
                    <h3>Shortly about us</h3>
                    <div class="wrapper">
                        <div class="inner-1 extra">
                            <p>Students at Sup'internet, Kremlin-Bicêtre France.<br />This website is a school project.<br /> QM let you manage your project. </p>
                            <div class="txt-1">
                                <ul>
                                    <li>Souleymane Diallo</li>
                                    <li>Stéphane Aboulaghras</li>
                                    <li>Alexandre François</li>
                                    <li>Nils</li>
                                    <li>Alexandre Ktifa</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
        </div>
    </footer>
</div>
{% endblock %}

{% if homeContext == false %}
<div id="modalHeadersLarge" class="modal hide fade">
    <!-- first modal window -->
    <header class="modal-header">
        <a href="#" class="close" data-dismiss="modal">x</a>
        <h6>Add a Ticket</h6>
    </header>

    <div class="modal-body">
        <form id="addTicket" action="/new-ticket" method="post" name="newTicket">
            <table>
                <tr>
                    <td><label for="nameTicket">Name :</label></td><td colspan="3"><input type="text" name="nameTicket" id="nameTicket"/></td>
                </tr>
                <tr>
                    <td><label for="descTicket">Description :</label></td><td colspan="3"><textarea name="descTicket" id="descTicket" rows="3"></textarea></td>
                </tr>
                <tr>
                    <td><label for="assignedTicket">Assigned to :</label></td>
                    <td>
                        <select name="assignedTicket" id="assignedTicket">
                            {% for members in modalTicket.services %}
                                {% if members.name != 'not-affiliated' %}
                                <option class="selectModalTicketService" value="{{ members.id_service }}">{{ members.name }}</option>
                                {% endif %}
                                {% for userTicket in members.members %}
                                    <option value="{{ userTicket.id }}">{{ userTicket.login }}</option>
                                {% endfor %}
                            {% endfor %}
                        </select>
                    </td>
                    <td><label for="deadlineTicket">Deadline :</label></td>
                    <td><input type="date" name="deadlineTicket" id="deadlineTicket" /></td>
                </tr>
                <tr>
                    <td><label for="priorityTicket">Priority :</label></td>
                    <td>
                        <select name="priorityTicket" id="priorityTicket">
                            <option value="1">Low</option>
                            <option value="2" selected="selected">Normal</option>
                            <option value="3">High</option>
                            <option value="4">Immediate</option>
                        </select>
                    </td>
                    <td><label for="trackerTicket">Tracker :</label></td>
                    <td>
                        <select name="trackerTicket" id="trackerTicket">
                            <option value="1" selected="selected">Evolution</option>
                            <option value="2">Bug</option>
                            <option value="3">Support</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="roadmapTicket">Link to a roadmap :</label></td>
                    <td colspan="3" id="selectRoadmap">
                        <select name="roadmapTicket" id="roadmapTicket">
                            <option selected="select" value="0">No roadmap linked</option>
                            {% for roadmap in modalTicket.roadmaps %}
                                <option value="{{ roadmap.id }}">{{ roadmap.title }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <footer class="modal-footer">
        <a href="#" class="btn btn-primary" id="okwin01" onclick="toolBarSubmit('ticket','{{ currentProject.project_id }}}','{{ currentProject.project_code }}')">Add</a>
    </footer>
</div>
        {% if currentPage == 'dashboard' %}
            <input type='hidden' name="modalReferer" id="modalReferer" value="{{ currentProject.project_code }}" />
        {% elseif detailContext %}
            <input type='hidden' name="modalReferer" id="modalReferer" value="{{ currentProject.project_code }}/{{ currentPage }}/{{ detailType }}/{{ detailCode }}" />
        {% else %}
            <input type='hidden' name="modalReferer" id="modalReferer" value="{{ currentProject.project_code }}/{{ currentPage }}" />
        {% endif %}
{% endif %}
</body>
</html>
